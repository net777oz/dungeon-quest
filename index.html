<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Little Explorer's Mysterious Dungeon</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="game-container">
        <canvas id="screen" width="640" height="480"></canvas>
        <div id="message-overlay"></div>
    </div>

    <div id="ui-panel">
        <h1>던전 퀘스트</h1>
        <div id="mode-display"><span id="mode-badge" class="mode-badge mode-play">로딩중...</span></div>

        <!-- Controls Hint -->
        <div class="section">
            <div class="controls-hint">
                <p><strong>🎮 게임하기</strong></p>
                <p><span class="btn-icon">화살표</span> 움직이기</p>
                <p><span class="btn-icon">A</span> 지도에 놓기</p>
                <p><span class="btn-icon">스페이스</span> 문열기 / 쾅!</p>
            </div>
        </div>

        <!-- Editor Specific UI -->
        <div id="editor-ui">
            <h2>🏗️ 지도 만들기</h2>

            <div
                style="background: #e74c3c; color: white; padding: 10px; border-radius: 8px; margin-bottom: 15px; font-size: 0.9em; line-height: 1.4;">
                <strong>👇 만드는 법:</strong><br>
                1. <strong>검은색(⬛)</strong>을 눌러서 길을 만드세요.<br>
                2. 드래그하면 길이 생겨요.<br>
                3. 문(🚪)이랑 보석(💎)은 <strong>길 위에</strong> 놓아주세요.<br>
                <span style="color:#fffaa0; font-size:0.8em;">* 벽(🧱) 위에는 안돼요!</span>
            </div>

            <div class="section">
                <label>지도 크기: <span id="size-label">10x10</span></label>
                <input type="range" id="size-slider" min="10" max="60" step="10" value="10">
                <button id="reset-map-btn">새로 만들기 (지우기)</button>
            </div>

            <div class="section" style="background: #34495e; padding: 10px; border-radius: 8px;">
                <label>📂 레벨 선택:</label>
                <select id="level-select" style="width: 100%; padding: 5px; margin-top: 5px;">
                    <!-- Populated by JS -->
                </select>
                <div style="margin-top: 10px; display: flex; gap: 5px;">
                    <button id="save-level-btn" style="flex:1; background: #27ae60;">💾 저장하기</button>
                    <button id="delete-level-btn" style="flex:1; background: #c0392b; display:none;">🗑️ 삭제</button>
                </div>
                <div style="margin-top: 5px; display: flex; gap: 5px;">
                    <button id="export-btn" style="flex:1; background: #8e44ad;">� 코드보기</button>
                </div>
                <textarea id="export-output"
                    style="width: 100%; height: 60px; margin-top: 10px; display: none; font-family: monospace; font-size: 0.8em;"
                    readonly onclick="this.select()"></textarea>
            </div>

            <div class="section">
                <h3>아이템 고르기</h3>
                <div class="palette-grid" id="palette-container"></div>
                <div id="selected-tool-name"
                    style="text-align:center; margin-top:10px; color:var(--highlight); font-weight:bold; height: 20px;">
                </div>
            </div>

            <div class="editor-controls">
                <button onclick="saveMap()">💾 Save</button>
                <button onclick="loadMap()">📂 Load</button>
                <button onclick="generateRandomMap()">🎲 Random</button>
            </div>

            <div class="section">
                <button id="play-btn" style="background:#2ecc71">▶️ 모험 떠나기!</button>
            </div>
        </div>

        <!-- Game Specific UI -->
        <div id="game-ui">
            <h2>🎒 내 가방</h2>
            <div class="inventory-grid">
                <div id="slot-map" class="inv-slot" title="지도">🗺️</div>
                <div id="slot-hammer" class="inv-slot" title="망치">🔨</div>
                <div id="slot-key1" class="inv-slot" title="철 열쇠">🔑</div>
                <div id="slot-key2" class="inv-slot" title="구리 열쇠">🔑</div>
                <div id="slot-key3" class="inv-slot" title="코발트 열쇠">🔑</div>
                <div id="slot-treasure" class="inv-slot" title="보석">💎 <span id="treasure-count">0</span></div>
            </div>
            <div style="margin-top: 30px;">
                <button id="edit-btn" style="background:#3498db">✏️ 지도 고치기</button>
            </div>
        </div>
    </div>

    <!-- MAIN ENTRY POINT -->
    <script type="module" src="js/main.js"></script>
</body>

</html>